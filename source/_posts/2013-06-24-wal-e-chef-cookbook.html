---
layout: post
title: "WAL-e chef cookbook"
date: 2013-06-24
comments: false
categories:
 - postgresql
---

<div class='post'>
<div style="background-color: white; color: #222222; font-family: arial; font-size: small; margin-bottom: 1.2em !important; margin-top: 1.2em !important;">Postgres has various backup and restore options</div><ul style="background-color: white; color: #222222; font-family: arial; font-size: small; margin: 1.2em 0px; padding-left: 2em;"><li style="margin: 0.5em 0px;"><a href="http://www.postgresql.org/docs/9.2/static/backup.html" style="color: #1155cc;"></a><a href="http://www.postgresql.org/docs/9.2/static/backup.html" style="color: #1155cc;">http://www.postgresql.org/docs/9.2/static/backup.html</a></li></ul><div style="background-color: white; color: #222222; font-family: arial; font-size: small; margin-bottom: 1.2em !important; margin-top: 1.2em !important;">Do you have a recovery plan in case your Postgres server crashes - your daily pg_dump is probably not going to cut it.</div><div style="background-color: white; color: #222222; font-family: arial; font-size: small; margin-bottom: 1.2em !important; margin-top: 1.2em !important;">Postgres uses Write-Ahead Logging (WAL)</div><blockquote style="background-color: white; border-left-color: rgb(221, 221, 221); border-left-style: solid; border-left-width: 4px; color: #777777; font-family: arial; font-size: small; margin: 1.2em 0px; padding: 0px 1em; quotes: none;"><div style="margin-bottom: 1.2em !important; margin-top: 1.2em !important;">Write-Ahead Logging (WAL) is a standard method for ensuring data integrity. A detailed description can be found in most (if not all) books about transaction processing. Briefly, WAL's central concept is that changes to data files (where tables and indexes reside) must be written only after those changes have been logged, that is, after log records describing the changes have been flushed to permanent storage. If we follow this procedure, we do not need to flush data pages to disk on every transaction commit, because we know that in the event of a crash we will be able to recover the database using the log: any changes that have not been applied to the data pages can be redone from the log records. (This is roll-forward recovery, also known as REDO.)</div></blockquote><ul style="background-color: white; color: #222222; font-family: arial; font-size: small; margin: 1.2em 0px; padding-left: 2em;"><li style="margin: 0.5em 0px;">from&nbsp;<a href="http://www.postgresql.org/docs/9.2/static/wal-intro.html" style="color: #1155cc;"></a><a href="http://www.postgresql.org/docs/9.2/static/wal-intro.html" style="color: #1155cc;">http://www.postgresql.org/docs/9.2/static/wal-intro.html</a></li></ul><div style="background-color: white; color: #222222; font-family: arial; font-size: small; margin-bottom: 1.2em !important; margin-top: 1.2em !important;">Setting up Continuous Archiving and Point-in-Time Recovery (PITR) for your Postgres WAL files is very complex, lucky for us the WAL-e project has simplified this process greatly. WAL-e has utilities for sending all WAL files to an AWS S3 bucket as the log files are being generated. More Information, see:</div><ul style="background-color: white; color: #222222; font-family: arial; font-size: small; margin: 1.2em 0px; padding-left: 2em;"><li style="margin: 0.5em 0px;"><a href="http://www.postgresql.org/docs/9.2/static/continuous-archiving.html" style="color: #1155cc;"></a><a href="http://www.postgresql.org/docs/9.2/static/continuous-archiving.html" style="color: #1155cc;">http://www.postgresql.org/docs/9.2/static/continuous-archiving.html</a></li></ul><ul style="background-color: white; color: #222222; font-family: arial; font-size: small; margin: 1.2em 0px; padding-left: 2em;"><li style="margin: 0.5em 0px;"><a href="https://github.com/wal-e/wal-e" style="color: #1155cc;"></a><a href="https://github.com/wal-e/wal-e" style="color: #1155cc;">https://github.com/wal-e/wal-e</a></li></ul><div style="background-color: white; color: #222222; font-family: arial; font-size: small; margin-bottom: 1.2em !important; margin-top: 1.2em !important;">Recently I put together a chef cookbook which installs WAL-e on a Postgres instance, see:</div><ul style="background-color: white; color: #222222; font-family: arial; font-size: small; margin: 1.2em 0px; padding-left: 2em;"><li style="margin: 0.5em 0px;"><a href="https://github.com/house9/wal-e-cookbook" style="color: #1155cc;"></a><a href="https://github.com/house9/wal-e-cookbook" style="color: #1155cc;">https://github.com/house9/wal-e-cookbook</a></li></ul><ul style="background-color: white; color: #222222; font-family: arial; font-size: small; margin: 1.2em 0px; padding-left: 2em;"><li style="margin: 0.5em 0px;"><a href="https://github.com/house9/use_wal_e" style="color: #1155cc;"></a><a href="https://github.com/house9/use_wal_e" style="color: #1155cc;">https://github.com/house9/use_wal_e</a></li></ul></div>
